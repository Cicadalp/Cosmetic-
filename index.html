<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Afro-Australian Cosmetic Survey</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #4e5d6c;
            --secondary-color: #b0c4de;
            --text-color: #333;
            --background-color: #f5f8ff;
            --card-background: #ffffff;
            --accent-color: #7395ae;
            --success-color: #4CAF50;
            --hover-color: #e6e6e6;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(120deg, #e0eafc, #cfdef3, #b0c4de, #7395ae);
            background-size: 400% 400%;
            animation: gradient-move 16s ease-in-out infinite;
            margin: 0;
            padding: 20px;
            color: var(--text-color);
        }
        @keyframes gradient-move {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .app-container {
            max-width: 900px;
            margin: 0 auto;
            background: linear-gradient(135deg, #f8faff 0%, #e0eafc 100%);
            padding: 40px;
            border-radius: 24px;
            box-shadow: 0 12px 32px rgba(0, 0, 0, 0.10);
            position: relative;
            overflow: hidden;
        }

        /* Progress Bar Styling */
        .progress-container {
            width: 100%;
            background-color: #e0eafc;
            border-radius: 10px;
            margin-bottom: 20px;
            overflow: hidden;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
        }
        .progress-bar {
            height: 20px;
            background: linear-gradient(90deg, var(--accent-color) 0%, #7395ae 100%);
            border-radius: 10px;
            width: 0%;
            transition: width 0.3s ease;
        }
        .progress-text {
            display: block;
            text-align: center;
            margin-top: 10px;
            font-weight: 600;
            color: var(--text-color);
        }

        /* Header Background Slideshow */
        .header-container {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
            height: 250px;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        .header-images {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0;
        }
        .header-images img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }
        .header-container::before {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(40, 40, 60, 0.45);
            z-index: 1;
        }
        .header-content {
            position: relative;
            z-index: 2;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            height: 100%;
        }
        .header-container h1,
        .header-container p {
            color: #fff;
            text-shadow: 1px 1px 8px rgba(0,0,0,0.45);
        }
        .header-container h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 700;
        }
        .header-container p {
            font-size: 1.1em;
            line-height: 1.6;
        }

        /* Gamified Mascot & Animation */
        .mascot-container {
            position: relative;
            text-align: center;
        }
        .mascot-img {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(115, 149, 174, 0.15);
            background: #fff;
            padding: 8px;
            display: block;
            margin: 0 auto 10px;
            animation: mascot-bounce 1.2s infinite alternate;
        }
        .mascot-emoji {
            font-size: 4.5em;
            display: block;
            margin: 0 auto;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.4), 0 0 10px rgba(255,255,255,0.5);
            transform: perspective(500px) rotateY(-15deg);
            animation: mascot-emoji-pop 1.2s infinite alternate;
        }
        #streak-counter {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255,255,255,0.8);
            padding: 5px 10px;
            border-radius: 10px;
            font-size: 0.8em;
        }
        .radio-label, .checkbox-label {
            min-height: 44px;
        }
        @keyframes mascot-bounce {
            0% { transform: translateY(0); }
            100% { transform: translateY(-10px); }
        }
        @keyframes mascot-emoji-pop {
            0% { transform: scale(1); }
            100% { transform: scale(1.2); }
        }

        /* Responsive Design */
        @media (max-width: 900px) {
            .app-container {
                padding: 20px;
            }
            .section-container {
                padding: 18px;
            }
            .header-container {
                height: 180px;
                padding: 10px;
            }
            .section-image {
                height: 160px;
            }
        }

        @media (max-width: 600px) {
            body {
                padding: 8px;
            }
            .app-container {
                padding: 8px;
                border-radius: 10px;
            }
            .header-container {
                height: auto !important;
                min-height: 120px;
                padding: 6px;
                border-radius: 8px;
            }
            .header-container h1 {
                font-size: 1.3em;
                margin-bottom: 6px;
            }
            .header-container p {
                font-size: 0.95em;
            }
            .section-container {
                padding: 8px;
                margin-bottom: 16px;
                border-radius: 6px;
            }
            .section-container h2 {
                font-size: 1.1em;
                padding-bottom: 4px;
                margin-bottom: 12px;
            }
            .question-container {
                padding: 10px 6px;
                border-radius: 8px;
                margin-bottom: 18px;
            }
            .question-text {
                font-size: 0.98em;
                margin-left: 2px;
            }
            .options-container {
                gap: 12px 10px;
            }
            .radio-label, .checkbox-label {
                padding: 7px 10px;
                font-size: 0.85em;
                border-radius: 16px;
            }
            .radio-button, .checkbox-box {
                width: 16px;
                height: 16px;
                margin-right: 6px;
            }
            .text-input, .dropdown-input {
                padding: 8px 8px;
                font-size: 0.95em;
                border-radius: 6px;
            }
            .button-container {
                flex-direction: column;
                gap: 10px;
                margin-top: 18px;
            }
            .button-container button {
                padding: 10px 18px;
                font-size: 1em;
                border-radius: 10px;
            }
            .footer-container p {
                font-size: 0.9em;
            }
            .congrats-popup {
                padding: 18px 12px;
                border-radius: 12px;
            }
            .congrats-emoji {
                font-size: 2em;
            }
            .congrats-text {
                font-size: 1em;
            }
            .section-image {
                height: 90px !important;
            }
        }

        /* Options Styling (Radio/Checkbox) */
        .options-container {
            display: flex;
            flex-wrap: wrap;
            gap: 28px 32px;
            margin-top: 10px;
        }
        .radio-label, .checkbox-label {
            display: inline-flex;
            align-items: center;
            cursor: pointer;
            padding: 12px 20px;
            border: 2px solid #ddd;
            border-radius: 25px;
            transition: all 0.2s ease-in-out;
            background-color: #fafafa;
            font-weight: 500;
            font-size: 0.9em;
        }
        .radio-label:hover, .checkbox-label:hover {
            border-color: var(--accent-color);
            background: linear-gradient(90deg, #e0eafc 0%, #b0c4de 100%);
            box-shadow: 0 4px 16px rgba(115, 149, 174, 0.13);
            transform: scale(1.06);
        }

        .radio-label.selected,
        .checkbox-label.selected {
            background: linear-gradient(90deg, #b0c4de 0%, #7395ae 100%);
            color: #fff;
            box-shadow: 0 0 12px #7395ae55;
            transform: scale(1.08);
            font-weight: 700;
            transition: all 0.25s cubic-bezier(.68,-0.55,.27,1.55);
            animation: radio-label-pop 0.3s cubic-bezier(.68,-0.55,.27,1.55);
        }
        @keyframes radio-label-pop {
            0% { transform: scale(0.9); opacity: 0.7; }
            100% { transform: scale(1.08); opacity: 1; }
        }

        .radio-label input[type="radio"], .checkbox-label input[type="checkbox"] {
            display: none;
        }
        .radio-button, .checkbox-box {
            width: 22px;
            height: 22px;
            border: 2px solid #7395ae;
            border-radius: 50%;
            display: inline-block;
            margin-right: 12px;
            position: relative;
            background: #fff;
            box-shadow: 0 1px 4px rgba(115, 149, 174, 0.10);
            transition: all 0.2s cubic-bezier(.68,-0.55,.27,1.55);
        }
        .checkbox-box {
            border-radius: 8px;
        }
        input[type="radio"]:checked + .radio-button::after {
            content: '';
            width: 12px;
            height: 12px;
            background: radial-gradient(circle, var(--accent-color) 70%, #fff 100%);
            border-radius: 50%;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(1.2);
            box-shadow: 0 0 8px #7395ae44;
            animation: radio-check-pop 0.3s cubic-bezier(.68,-0.55,.27,1.55);
        }
        @keyframes radio-check-pop {
            0% { transform: translate(-50%, -50%) scale(0.7); opacity: 0.5; }
            100% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
        }
        input[type="checkbox"]:checked + .checkbox-box::after {
            content: '‚úì';
            color: #fff;
            font-size: 16px;
            font-weight: bold;
            background: linear-gradient(135deg, var(--accent-color) 60%, #7395ae 100%);
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            box-shadow: 0 0 8px #7395ae44;
            animation: checkbox-check-pop 0.3s cubic-bezier(.68,-0.55,.27,1.55);
        }
        @keyframes checkbox-check-pop {
            0% { transform: scale(0.7); opacity: 0.5; }
            100% { transform: scale(1.1); opacity: 1; }
        }

        /* Input Fields */
        .text-input, .dropdown-input {
            width: 100%;
            padding: 12px 15px;
            font-size: 1em;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-sizing: border-box;
            transition: all 0.2s ease;
        }
        .text-input:focus, .dropdown-input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 5px rgba(115, 149, 174, 0.5);
        }
        .text-group-container {
            display: grid;
            gap: 20px;
        }
        .text-group-field label {
            font-weight: 600;
            display: block;
            margin-bottom: 5px;
        }

        /* Extra Fields Styling for q21 */
        .extra-fields-container {
            display: none;
            margin-top: 15px;
            padding: 15px;
            background: linear-gradient(135deg, #f8faff 0%, #e0eafc 100%);
            border-radius: 12px;
            border: 1px solid var(--secondary-color);
        }
        .extra-header {
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--accent-color);
            font-size: 1em;
        }
        .extra-fields-container label {
            display: block;
            font-weight: 500;
            margin-bottom: 5px;
            color: var(--text-color);
        }
        .extra-fields-container input {
            width: 100%;
            margin-bottom: 12px;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.95em;
            box-sizing: border-box;
        }
        .extra-fields-container input:focus {
            outline: none;
            border-color: var(--accent-color);
            box-shadow: 0 0 5px rgba(115, 149, 174, 0.3);
        }

        /* Button Styling */
        .button-container {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
        }
        .button-container button {
            padding: 14px 32px;
            background: linear-gradient(90deg, #7395ae 0%, #b0c4de 100%);
            color: #fff;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(115, 149, 174, 0.10);
            transition: background 0.2s, transform 0.2s;
            animation: btn-pop 1.2s infinite alternate;
        }
        .button-container button:hover {
            background: linear-gradient(90deg, #4e5d6c 0%, #7395ae 100%);
            transform: scale(1.09);
        }
        @keyframes btn-pop {
            0% { transform: scale(1); }
            100% { transform: scale(1.07); }
        }

        /* Footer Styling */
        .footer-container {
            text-align: center;
        }
        .footer-container p {
            color: #555;
            font-style: italic;
            margin-bottom: 20px;
        }

        /* Language notification popup */
        .lang-notify-popup {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #e8f5e8 0%, #c8e6c9 100%);
            color: #2e7d32;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.15);
            padding: 16px 24px;
            z-index: 1000;
            display: flex;
            align-items: center;
            animation: notify-fade-in 0.5s ease;
        }
        .lang-notify-text {
            font-size: 1em;
            font-weight: 500;
        }
        @keyframes notify-fade-in {
            0% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
            100% { opacity: 1; transform: translateX(-50%) translateY(0); }
        }
        @keyframes notify-fade-out {
            0% { opacity: 1; transform: translateX(-50%) translateY(0); }
            100% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
        }

        /* Gamified congrats popup */
        .congrats-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #fff6b7 0%, #f6416c 100%);
            color: #333;
            border-radius: 24px;
            box-shadow: 0 4px 24px rgba(246, 65, 108, 0.15);
            padding: 32px 48px;
            z-index: 999;
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: congrats-pop 0.7s ease;
        }
        .congrats-emoji {
            font-size: 3em;
            margin-bottom: 12px;
            animation: mascot-emoji-pop 1.2s infinite alternate;
        }
        .congrats-text {
            font-size: 1.5em;
            font-weight: bold;
            color: #f6416c;
        }
        @keyframes congrats-pop {
            0% { opacity: 0; transform: scale(0.7) translate(-50%, -50%); }
            100% { opacity: 1; transform: scale(1) translate(-50%, -50%); }
        }

        /* Sad popup */
        .sad-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);
            color: #333;
            border-radius: 24px;
            box-shadow: 0 4px 24px rgba(0, 188, 212, 0.15);
            padding: 32px 48px;
            z-index: 999;
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: sad-pop 0.7s ease;
        }
        .sad-emoji {
            font-size: 3em;
            margin-bottom: 12px;
            animation: sad-emoji-droop 1.2s infinite alternate;
        }
        .sad-text {
            font-size: 1.5em;
            font-weight: bold;
            color: #00acc1;
        }
        @keyframes sad-pop {
            0% { opacity: 0; transform: scale(0.7) translate(-50%, -50%); }
            100% { opacity: 1; transform: scale(1) translate(-50%, -50%); }
        }
        @keyframes sad-emoji-droop {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(-5deg); }
        }
        /* Section Image Styling */
        .section-image-container {
            margin-top: 30px;
            margin-bottom: 20px;
            text-align: center;
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
        .section-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
            display: block;
        }

        /* Feedback Container Styling */
        .feedback-container {
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-top: 15px;
            padding: 10px;
            background: linear-gradient(135deg, #f0f8ff 0%, #e6f3ff 100%);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(115, 149, 174, 0.15);
            animation: feedbackFadeIn 0.5s ease-out;
        }
        .feedback-container.fade-out {
            animation: feedbackFadeOut 0.5s ease-in;
        }
        @keyframes feedbackFadeIn {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }
        @keyframes feedbackFadeOut {
            from { opacity: 1; transform: scale(1); }
            to { opacity: 0; transform: scale(0.9); }
        }
        .feedback-emoji {
            font-size: 2.5em;
            margin-bottom: 5px;
        }
        .feedback-word {
            font-size: 1.2em;
            font-weight: bold;
            color: var(--accent-color);
            margin-bottom: 5px;
        }
        .feedback-image {
            font-size: 2em;
            margin-bottom: 5px;
        }
        .continue-text {
            font-size: 0.9em;
            color: #555;
            font-style: italic;
        }

        /* Header Background Slideshow */
        .header-container {
            text-align: center;
            margin-bottom: 30px;
            position: relative; /* Needed for absolute positioning of the pseudo-element */
            overflow: hidden; /* Hides the part of the image not in view */
            height: 250px; /* Set a fixed height to contain the background images */
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            display: flex; /* For centering content */
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .header-container::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.3); /* Semi-transparent overlay */
            z-index: 1; /* Places the overlay above the images but below the text */
        }

        .header-container h1,
        .header-container p {
            position: relative;
            z-index: 2; /* Ensures text is above the overlay */
            color: #ffffff; /* Change text color to white for readability */
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.5);
        }

        #lang-toggle {
            display: block;
            margin: 10px auto 0;
            padding: 14px 28px;
            background: linear-gradient(90deg, #4CAF50 0%, #8BC34A 100%);
            color: #fff;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            box-shadow: 0 2px 8px rgba(76, 175, 80, 0.10);
            transition: background 0.2s, transform 0.2s;
            animation: shine 2s infinite;
        }

        @keyframes shine {
            0% { box-shadow: 0 2px 8px rgba(76, 175, 80, 0.10); }
            50% { box-shadow: 0 2px 20px rgba(76, 175, 80, 0.50), 0 0 30px rgba(139, 195, 74, 0.30); }
            100% { box-shadow: 0 2px 8px rgba(76, 175, 80, 0.10); }
        }

        #lang-toggle:hover {
            background: linear-gradient(90deg, #388E3C 0%, #689F38 100%);
            transform: scale(1.05);
            animation-play-state: paused;
        }

        /* Language selection overlay */
        .language-selection-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        .language-selection-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        .language-selection-content h1 {
            margin-bottom: 30px;
            font-size: 2em;
            color: var(--primary-color);
        }
        .language-selection-content button {
            position: absolute;
            margin: 10px;
            padding: 15px 30px;
            font-size: 18px;
            cursor: pointer;
            border: none;
            border-radius: 10px;
            background: linear-gradient(90deg, #7395ae 0%, #b0c4de 100%);
            color: white;
            transition: transform 0.2s;
        }
        .language-selection-content button:hover {
            transform: scale(1.05);
        }
        #select-en {
            top: 50%;
            left: 30%;
            transform: translate(-50%, -50%);
        }
        #select-fr {
            top: 50%;
            right: 30%;
            transform: translate(50%, -50%);
        }
    </style>
</head>
<body>
    <div class="language-selection-overlay" id="language-overlay">
        <div class="language-selection-content">
            <h1>Select Your Language</h1>
            <button id="select-en">English</button>
            <button id="select-fr">Fran√ßais</button>
        </div>
    </div>
    <div class="app-container">
        <div class="mascot-container">
            
            <span class="mascot-emoji" id="mascot-emoji" role="img" aria-label="mascot">‚ú®</span>
            <div id="streak-counter" style="display: none;">Streak: <span id="streak-count">0</span></div>
        </div>
        <div class="header-container">
            <div class="header-images">
                <img src="./assets/Woman.jpg" alt="Header Image">
            </div>
            <div class="header-content">
                <h1>Afro-Australian Cosmetic Line: Consumer Insights Survey</h1>
                <p>We're developing a new line of premium beauty products that blend the best natural ingredients from Africa and Australia. Your feedback will directly shape our formulations and help us create products that truly meet your needs.</p>
            </div>
        </div>

        <div class="progress-container">
            <div id="progress-bar" class="progress-bar"></div>
            <span id="progress-text" class="progress-text">0/5</span>
            <button id="lang-toggle" aria-label="Toggle language">Fran√ßais</button>
        </div>

        <div class="survey-form">
            <div id="survey-content"></div>
            <div class="button-container">
                <button id="prev-btn" class="game-btn" style="display: none;" aria-label="Previous section">‚¨ÖÔ∏è Previous</button>
                <button id="next-btn" class="game-btn" aria-label="Next section">Next ‚û°Ô∏è</button>
                <button id="submit-btn" class="game-btn" style="display: none;" aria-label="Submit survey">Submit</button>
            </div>
        </div>

        <div id="congrats-popup" class="congrats-popup" style="display: none;">
            <span role="img" aria-label="congrats" class="congrats-emoji">üéä</span>
            <span class="congrats-text" id="congrats-text">Congratulations, you have completed the survey!</span>
        </div>

        <div id="sad-popup" class="sad-popup" style="display: none;">
            <span role="img" aria-label="sad" class="sad-emoji">üò¢</span>
            <span class="sad-text" id="sad-text">Why are you not answering all?</span>
        </div>



        <div id="congrats-popup" class="congrats-popup" style="display: none;">
            <span role="img" aria-label="congrats" class="congrats-emoji">üéä</span>
            <span class="congrats-text" id="congrats-text">Congratulations, you have completed the survey!</span>
        </div>
    </div>

    <script>
        const surveyData = {
            en: {
                title: "Afro-Australian Cosmetic Line: Consumer Insights Survey",
                description: "We're developing a new line of premium beauty products that blend the best natural ingredients from Africa and Australia. Your feedback will directly shape our formulations and help us create products that truly meet your needs.",
                sections: [
                    {
                        title: "Section 1: About You",
                        questions: [
                            { id: "q1", text: "1. Age Group:", type: "radio", options: ["Under 18", "18-24", "25-34", "35-44", "45-54", "55+"], required: true },
                            { id: "q2", text: "2. Location:", type: "text", placeholder: "e.g., Cameroon, Australia", required: true },
                            { id: "q3", text: "3. Which best describes your lifestyle? (Select all that apply)", type: "checkbox", options: ["Busy & always on-the-go", "Health and wellness focused", "Minimalist / simple", "Active / sporty", "Trend-conscious / fashionable", "Other:"], required: true },
                            { id: "q4", text: "4. How important are natural and organic ingredients to you?", type: "radio", options: ["Not important", "Slightly important", "Important", "Very Important", "Essential - I only buy natural/organic"], required: true }
                        ]
                    },
                    {
                        title: "Section 2: Your Skin & Hair Profile",
                        questions: [
                            { id: "q5", text: "5. What is your skin type?", type: "radio", options: ["Oily", "Dry", "Combination", "Normal", "Sensitive"], required: true },
                            { id: "q6", text: "6. What is your hair type/texture?", type: "text", placeholder: "e.g., Curly, Straight, Wavy", required: true },
                            { id: "q7", text: "7. What are your TOP 3 skin concerns? (Select up to 3)", type: "checkbox", options: ["Acne/breakouts", "Dark spots/hyperpigmentation", "Dryness/flakiness", "Oiliness/shine", "Fine lines/wrinkles", "Dullness", "Redness/irritation", "Large pores", "Uneven skin tone", "Other:"], required: true },
                            { id: "q8", text: "8. What are your TOP 3 hair concerns? (Select up to 3)", type: "checkbox", options: ["Dryness", "Breakage/split ends", "Scalp issues (dandruff, itchiness)", "Slow growth", "Lack of curl definition", "Frizz", "Damage from heat/chemicals", "Thinning", "Tangling", "Other:"], required: true }
                        ]
                    },
                    {
                        title: "Section 3: Your Beauty Habits",
                        questions: [
                            { id: "q9", text: "9. Where do you typically shop for beauty products? (Select all that apply)", type: "checkbox", options: ["Pharmacies/drugstores", "Beauty salons", "Supermarkets", "Online marketplaces (Amazon, Jumia, etc.)", "Brand websites", "Social media sellers", "Local markets", "Specialty beauty stores", "Department stores"], required: true },
                            { id: "q10", text: "10. On average, how much do you spend monthly on skincare AND haircare?", type: "radio", options: ["Less than 10,000 XAF / $20 AUD", "10,000 - 30,000 XAF / $20 - $60 AUD", "30,000 - 50,000 XAF / $60 - $100 AUD", "More than 50,000 XAF / $100 AUD"], required: true },
                            { id: "q11", text: "11. How often do you purchase new beauty products?", type: "radio", options: ["Weekly", "Monthly", "Every 2-3 months", "Every 4-6 months", "Only when I run out", "Rarely"], required: true }
                        ]
                    },
                    {
                        title: "Section 4: Product Preferences",
                        questions: [
                            { id: "q12", text: "12. How appealing is the concept of combining African & Australian natural ingredients?", type: "radio", options: ["Not appealing at all", "Slightly appealing", "Neutral", "Appealing", "Very appealing"], required: true },
                            { id: "q13", text: "13. Which product types interest you most? (Rank your top 3)", type: "checkbox", options: ["Moisturizing creams/lotions", "Hair growth serums/oils", "Shampoo & conditioner sets", "Face masks", "Body butters/scrubs", "Scalp treatments", "Leave-in conditioners", "Cleansers & toners", "Styling products", "Lip care"], required: true },
                            { id: "q14", text: "14. What's MOST important when choosing beauty products?", type: "radio", options: ["Ingredients quality", "Brand reputation", "Price/value", "Recommendations/reviews", "Packaging", "Effectiveness/results", "Natural/organic certification"], required: true },
                            { id: "q15", text: "15. What scent profiles do you prefer? (Select all that apply)", type: "checkbox", options: ["Fresh & herbal (eucalyptus, mint, tea tree)", "Floral (lavender, rose, jasmine)", "Woody & earthy (sandalwood, cedarwood)", "Fruity & sweet (coconut, vanilla, citrus)", "Unscented/fragrance-free"], required: true },
                            { id: "q16", text: "16. How important is eco-friendly/sustainable packaging?", type: "radio", options: ["Not important", "Slightly important", "Important", "Very important", "Essential"], required: true }
                        ]
                    },
                    {
                        title: "Section 5: The Afro-Australian Concept",
                        questions: [
                            { id: "q17", text: "17. What African ingredients are you most familiar with? (Select all that apply)", type: "checkbox", options: ["Shea butter", "Baobab oil", "Marula oil", "Argan oil", "African black soap", "Cocoa butter", "Other:"], required: true },
                            { id: "q18", text: "18. What Australian ingredients interest you most? (Select all that apply)", type: "checkbox", options: ["Tea tree oil", "Macadamia oil", "Kakadu plum", "Eucalyptus", "Emu oil", "Other:"], required: true },
                            { id: "q19", text: "19. What benefits are most important in your beauty products? (Select top 3)", type: "checkbox", options: ["Deep hydration/moisture", "Natural healing properties", "Anti-aging effects", "Brightening/even tone", "Soothing sensitive skin", "Strengthening hair", "Protecting from environmental damage", "Lightweight feel (not greasy)", "Quick absorption", "Long-lasting results"], required: true },
                            { id: "q20", text: "20. What price point feels right for premium natural products?", type: "radio", options: ["Budget-friendly (under 15,000 XAF / $30 AUD)", "Mid-range (15,000-35,000 XAF / $30-$70 AUD)", "Premium (35,000-60,000 XAF / $70-$120 AUD)", "Luxury (over 60,000 XAF / $120 AUD)"], required: true },
                            { id: "q21", text: "21. Would you like to participate further?", type: "checkbox", options: ["Yes, I'd like to be a product tester", "Yes, I'm interested in the Beauty Ambassador contest", "Yes, notify me when products launch", "No, just completing the survey"], extraFields: true, required: true }
                        ]
                    }
                ]
            },
            fr: {
                title: "Ligne Cosm√©tique Afro-Australienne : Enqu√™te sur les Consommateurs",
                description: "Nous d√©veloppons une nouvelle ligne de produits de beaut√© haut de gamme qui allie les meilleurs ingr√©dients naturels d'Afrique et d'Australie. Vos retours fa√ßonneront directement nos formulations et nous aideront √† cr√©er des produits qui r√©pondent vraiment √† vos besoins.",
                sections: [
                    {
                        title: "Section 1 : √Ä propos de vous",
                        questions: [
                            { id: "q1", text: "1. Groupe d'√¢ge :", type: "radio", options: ["Moins de 18 ans", "18-24", "25-34", "35-44", "45-54", "55+"], required: true },
                            { id: "q2", text: "2. Localisation :", type: "text", placeholder: "ex. : Cameroun, Australie", required: true },
                            { id: "q3", text: "3. Lequel d√©crit le mieux votre style de vie ? (S√©lectionnez tout ce qui s'applique)", type: "checkbox", options: ["Occup√© et toujours en d√©placement", "Ax√© sur la sant√© et le bien-√™tre", "Minimaliste / simple", "Actif / sportif", "Conscient des tendances / √† la mode", "Autre :"], required: true },
                            { id: "q4", text: "4. Quelle importance accordez-vous aux ingr√©dients naturels et biologiques ?", type: "radio", options: ["Pas important", "L√©g√®rement important", "Important", "Tr√®s important", "Essentiel - Je n'ach√®te que naturel/biologique"], required: true }
                        ]
                    },
                    {
                        title: "Section 2 : Votre profil de peau et de cheveux",
                        questions: [
                            { id: "q5", text: "5. Quel est votre type de peau ?", type: "radio", options: ["Grasse", "S√®che", "Mixte", "Normale", "Sensible"], required: true },
                            { id: "q6", text: "6. Quel est votre type/texture de cheveux ?", type: "text", placeholder: "ex. : Boucl√©s, Raides, Ondul√©s", required: true },
                            { id: "q7", text: "7. Quelles sont vos 3 principales pr√©occupations cutan√©es ? (S√©lectionnez jusqu'√† 3)", type: "checkbox", options: ["Acn√©/√©ruptions", "Taches fonc√©es/hyperpigmentation", "S√©cheresse/peau qui p√®le", "Brillance/peau grasse", "Rides/ridules", "Teint terne", "Rougeurs/irritations", "Pores dilat√©s", "Teint irr√©gulier", "Autre :"], required: true },
                            { id: "q8", text: "8. Quelles sont vos 3 principales pr√©occupations capillaires ? (S√©lectionnez jusqu'√† 3)", type: "checkbox", options: ["S√©cheresse", "Casse/pointes fourchues", "Probl√®mes de cuir chevelu (pellicules, d√©mangeaisons)", "Croissance lente", "Manque de d√©finition des boucles", "Frisottis", "Dommages caus√©s par la chaleur/produits chimiques", "Amincissement", "Emm√™lements", "Autre :"], required: true }
                        ]
                    },
                    {
                        title: "Section 3 : Vos habitudes de beaut√©",
                        questions: [
                            { id: "q9", text: "9. O√π achetez-vous g√©n√©ralement vos produits de beaut√© ? (S√©lectionnez tout ce qui s'applique)", type: "checkbox", options: ["Pharmacies/parapharmacies", "Salons de beaut√©", "Supermarch√©s", "March√©s en ligne (Amazon, Jumia, etc.)", "Sites de marques", "Vendeurs sur les r√©seaux sociaux", "March√©s locaux", "Magasins de beaut√© sp√©cialis√©s", "Grands magasins"], required: true },
                            { id: "q10", text: "10. En moyenne, combien d√©pensez-vous par mois pour les soins de la peau ET des cheveux ?", type: "radio", options: ["Moins de 10 000 XAF / 20 $ AUD", "10 000 - 30 000 XAF / 20 - 60 $ AUD", "30 000 - 50 000 XAF / 60 - 100 $ AUD", "Plus de 50 000 XAF / 100 $ AUD"], required: true },
                            { id: "q11", text: "11. √Ä quelle fr√©quence achetez-vous de nouveaux produits de beaut√© ?", type: "radio", options: ["Hebdomadaire", "Mensuel", "Tous les 2-3 mois", "Tous les 4-6 mois", "Seulement quand j'en manque", "Rarement"], required: true }
                        ]
                    },
                    {
                        title: "Section 4 : Pr√©f√©rences de produits",
                        questions: [
                            { id: "q12", text: "12. Quelle est l'attractivit√© du concept de combiner des ingr√©dients naturels africains et australiens ?", type: "radio", options: ["Pas du tout attractif", "L√©g√®rement attractif", "Neutre", "Attractif", "Tr√®s attractif"], required: true },
                            { id: "q13", text: "13. Quels types de produits vous int√©ressent le plus ? (Classez vos 3 pr√©f√©r√©s)", type: "checkbox", options: ["Cr√®mes/lotions hydratantes", "S√©rums/huiles pour la croissance des cheveux", "Ensembles shampooing & apr√®s-shampooing", "Masques pour le visage", "Beurres/gommages pour le corps", "Soins du cuir chevelu", "Apr√®s-shampooings sans rin√ßage", "Nettoyants & toniques", "Produits coiffants", "Soins des l√®vres"], required: true },
                            { id: "q14", text: "14. Qu'est-ce qui est le PLUS important lors du choix des produits de beaut√© ?", type: "radio", options: ["Qualit√© des ingr√©dients", "R√©putation de la marque", "Prix/valeur", "Recommandations/avis", "Emballage", "Efficacit√©/r√©sultats", "Certification naturelle/biologique"], required: true },
                            { id: "q15", text: "15. Quels profils de parfum pr√©f√©rez-vous ? (S√©lectionnez tout ce qui s'applique)", type: "checkbox", options: ["Frais & herbac√© (eucalyptus, menthe, arbre √† th√©)", "Floral (lavande, rose, jasmin)", "Bois√© & terreux (bois de santal, c√®dre)", "Fruit√© & sucr√© (noix de coco, vanille, agrumes)", "Sans parfum/fragrance"], required: true },
                            { id: "q16", text: "16. Quelle importance accordez-vous √† un emballage √©cologique/durable ?", type: "radio", options: ["Pas important", "L√©g√®rement important", "Important", "Tr√®s important", "Essentiel"], required: true }
                        ]
                    },
                    {
                        title: "Section 5 : Le concept Afro-Australien",
                        questions: [
                            { id: "q17", text: "17. Quels ingr√©dients africains connaissez-vous le mieux ? (S√©lectionnez tout ce qui s'applique)", type: "checkbox", options: ["Beurre de karit√©", "Huile de baobab", "Huile de marula", "Huile d'argan", "Savon noir africain", "Beurre de cacao", "Autre :"], required: true },
                            { id: "q18", text: "18. Quels ingr√©dients australiens vous int√©ressent le plus ? (S√©lectionnez tout ce qui s'applique)", type: "checkbox", options: ["Huile d'arbre √† th√©", "Huile de macadamia", "Prune Kakadu", "Eucalyptus", "Huile d'√©meu", "Autre :"], required: true },
                            { id: "q19", text: "19. Quels b√©n√©fices sont les plus importants dans vos produits de beaut√© ? (S√©lectionnez les 3 principaux)", type: "checkbox", options: ["Hydratation/profonde", "Propri√©t√©s naturelles cicatrisantes", "Effets anti-√¢ge", "√âclaircissant/teint uniforme", "Apaisant pour peau sensible", "Renforcement des cheveux", "Protection contre les agressions environnementales", "Sensation l√©g√®re (non grasse)", "Absorption rapide", "R√©sultats durables"], required: true },
                            { id: "q20", text: "20. Quel prix vous semble adapt√© pour des produits naturels haut de gamme ?", type: "radio", options: ["Abordable (moins de 15 000 XAF / 30 $ AUD)", "Moyenne gamme (15 000-35 000 XAF / 30-70 $ AUD)", "Premium (35 000-60 000 XAF / 70-120 $ AUD)", "Luxe (plus de 60 000 XAF / 120 $ AUD)"], required: true },
                            { id: "q21", text: "21. Souhaitez-vous participer davantage ?", type: "checkbox", options: ["Oui, je souhaite √™tre testeur de produit", "Oui, je suis int√©ress√© par le concours Ambassadeur de Beaut√©", "Oui, pr√©venez-moi lors du lancement des produits", "Non, je compl√®te juste l'enqu√™te"], extraFields: true, required: true }
                        ]
                    }
                ]
            }
        };

        let currentLang = 'en';
        let currentSectionIndex = 0;
        let answers = {};
        let score = 0;
        let visits = 0;

        const mascotEmojis = ["‚ú®", "üíÑ", "üëë", "üíñ", "üå∏", "üßñ‚Äç‚ôÄÔ∏è", "üíÖ", "üë©üèæ‚Äçü¶±", "üë©üèΩ‚Äçü¶±", "üíÅüèæ‚Äç‚ôÄÔ∏è", "üíÅüèΩ‚Äç‚ôÄÔ∏è"];

        const buttonTexts = {
            en: { prev: 'Previous', next: 'Next', submit: 'Submit' },
            fr: { prev: 'Pr√©c√©dent', next: 'Suivant', submit: 'Soumettre' }
        };

        const congratsTexts = {
            en: 'Congratulations, you have completed the survey!',
            fr: 'Bravo, tu as termin√© !'
        };

        const alertTexts = {
            en: { success: 'Thank you for your responses!', error: 'Submission error. Please try again.' },
            fr: { success: 'Merci pour vos r√©ponses !', error: 'Erreur lors de la soumission. Veuillez r√©essayer.' }
        };

        // Feedback mappings for each question
        const feedbackMap = {
            q1: {
                "Under 18": { emoji: "üëß", word: "Young", imageEmoji: "üåü", continueText: "Let's continue" },
                "18-24": { emoji: "üë©", word: "Youthful", imageEmoji: "üíÉ", continueText: "Let's continue" },
                "25-34": { emoji: "üë©‚Äçüíº", word: "Mature", imageEmoji: "üå∏", continueText: "Let's continue" },
                "35-44": { emoji: "üë©‚Äçü¶≥", word: "Experienced", imageEmoji: "üåø", continueText: "Let's continue" },
                "45-54": { emoji: "üë©‚Äçü¶±", word: "Wise", imageEmoji: "üå∫", continueText: "Let's continue" },
                "55+": { emoji: "üëµ", word: "Elegant", imageEmoji: "üíé", continueText: "Let's continue" },
                default: { emoji: "üëß", word: "Young", imageEmoji: "üåü", continueText: "Let's continue" }
            },
            q2: { default: { emoji: "üåç", word: "Global", imageEmoji: "üó∫Ô∏è", continueText: "Let's continue" } },
            q3: { default: { emoji: "üèÉ‚Äç‚ôÄÔ∏è", word: "Active", imageEmoji: "üí™", continueText: "Let's continue" } },
            q4: {
                "Not important": { emoji: "ü§∑‚Äç‚ôÄÔ∏è", word: "Casual", imageEmoji: "üòê", continueText: "Let's continue" },
                "Slightly important": { emoji: "ü§î", word: "Curious", imageEmoji: "üîç", continueText: "Let's continue" },
                "Important": { emoji: "üëç", word: "Valued", imageEmoji: "‚úÖ", continueText: "Let's continue" },
                "Very Important": { emoji: "üíö", word: "Passionate", imageEmoji: "‚ù§Ô∏è", continueText: "Let's continue" },
                "Essential - I only buy natural/organic": { emoji: "üå±", word: "Dedicated", imageEmoji: "üåø", continueText: "Let's continue" },
                default: { emoji: "üå±", word: "Natural", imageEmoji: "üåø", continueText: "Let's continue" }
            },
            q5: {
                "Oily": { emoji: "üíß", word: "Shiny", imageEmoji: "üåä", continueText: "Let's continue" },
                "Dry": { emoji: "üèúÔ∏è", word: "Thirsty", imageEmoji: "üåµ", continueText: "Let's continue" },
                "Combination": { emoji: "‚öñÔ∏è", word: "Balanced", imageEmoji: "üßò‚Äç‚ôÄÔ∏è", continueText: "Let's continue" },
                "Normal": { emoji: "üòä", word: "Perfect", imageEmoji: "üåû", continueText: "Let's continue" },
                "Sensitive": { emoji: "ü§ï", word: "Gentle", imageEmoji: "üõ°Ô∏è", continueText: "Let's continue" },
                default: { emoji: "üòä", word: "Perfect", imageEmoji: "üåû", continueText: "Let's continue" }
            },
            q6: { default: { emoji: "üíá‚Äç‚ôÄÔ∏è", word: "Stylish", imageEmoji: "‚úÇÔ∏è", continueText: "Let's continue" } },
            q7: { default: { emoji: "üß¥", word: "Caring", imageEmoji: "üßº", continueText: "Let's continue" } },
            q8: { default: { emoji: "üß¥", word: "Nurturing", imageEmoji: "üíÜ‚Äç‚ôÄÔ∏è", continueText: "Let's continue" } },
            q9: { default: { emoji: "üõí", word: "Shopper", imageEmoji: "üõçÔ∏è", continueText: "Let's continue" } },
            q10: {
                "Less than 10,000 XAF / $20 AUD": { emoji: "üí∏", word: "Budget", imageEmoji: "ü§ë", continueText: "Let's continue" },
                "10,000 - 30,000 XAF / $20 - $60 AUD": { emoji: "üí∞", word: "Moderate", imageEmoji: "üíµ", continueText: "Let's continue" },
                "30,000 - 50,000 XAF / $60 - $100 AUD": { emoji: "üí≥", word: "Generous", imageEmoji: "üí≥", continueText: "Let's continue" },
                "More than 50,000 XAF / $100 AUD": { emoji: "üíé", word: "Luxury", imageEmoji: "üëë", continueText: "Let's continue" },
                default: { emoji: "üí∞", word: "Moderate", imageEmoji: "üíµ", continueText: "Let's continue" }
            },
            q11: {
                "Weekly": { emoji: "üìÖ", word: "Frequent", imageEmoji: "üîÑ", continueText: "Let's continue" },
                "Monthly": { emoji: "üìÜ", word: "Regular", imageEmoji: "üóìÔ∏è", continueText: "Let's continue" },
                "Every 2-3 months": { emoji: "‚è∞", word: "Occasional", imageEmoji: "üïí", continueText: "Let's continue" },
                "Every 4-6 months": { emoji: "üïê", word: "Selective", imageEmoji: "üïï", continueText: "Let's continue" },
                "Only when I run out": { emoji: "üõë", word: "Practical", imageEmoji: "üö´", continueText: "Let's continue" },
                "Rarely": { emoji: "üêå", word: "Minimalist", imageEmoji: "ü¶•", continueText: "Let's continue" },
                default: { emoji: "üìÜ", word: "Regular", imageEmoji: "üóìÔ∏è", continueText: "Let's continue" }
            },
            q12: {
                "Not appealing at all": { emoji: "üòí", word: "Skeptical", imageEmoji: "üôÑ", continueText: "Let's continue" },
                "Slightly appealing": { emoji: "ü§®", word: "Intrigued", imageEmoji: "üßê", continueText: "Let's continue" },
                "Neutral": { emoji: "üòê", word: "Open", imageEmoji: "ü§∑‚Äç‚ôÄÔ∏è", continueText: "Let's continue" },
                "Appealing": { emoji: "üòä", word: "Interested", imageEmoji: "üëç", continueText: "Let's continue" },
                "Very appealing": { emoji: "üòç", word: "Excited", imageEmoji: "‚ù§Ô∏è", continueText: "Let's continue" },
                default: { emoji: "üòä", word: "Interested", imageEmoji: "üëç", continueText: "Let's continue" }
            },
            q13: { default: { emoji: "üß¥", word: "Productive", imageEmoji: "üõçÔ∏è", continueText: "Let's continue" } },
            q14: {
                "Ingredients quality": { emoji: "üåø", word: "Natural", imageEmoji: "üçÉ", continueText: "Let's continue" },
                "Brand reputation": { emoji: "üè∑Ô∏è", word: "Trusted", imageEmoji: "‚≠ê", continueText: "Let's continue" },
                "Price/value": { emoji: "üí∞", word: "Smart", imageEmoji: "ü§ë", continueText: "Let's continue" },
                "Recommendations/reviews": { emoji: "üí¨", word: "Social", imageEmoji: "üë•", continueText: "Let's continue" },
                "Packaging": { emoji: "üì¶", word: "Aesthetic", imageEmoji: "üé®", continueText: "Let's continue" },
                "Effectiveness/results": { emoji: "üéØ", word: "Results", imageEmoji: "‚úÖ", continueText: "Let's continue" },
                "Natural/organic certification": { emoji: "üå±", word: "Organic", imageEmoji: "üåæ", continueText: "Let's continue" },
                default: { emoji: "üåø", word: "Natural", imageEmoji: "üçÉ", continueText: "Let's continue" }
            },
            q15: { default: { emoji: "üå∏", word: "Scented", imageEmoji: "üïØÔ∏è", continueText: "Let's continue" } },
            q16: {
                "Not important": { emoji: "üóëÔ∏è", word: "Casual", imageEmoji: "üöÆ", continueText: "Let's continue" },
                "Slightly important": { emoji: "ü§î", word: "Aware", imageEmoji: "üåç", continueText: "Let's continue" },
                "Important": { emoji: "‚ôªÔ∏è", word: "Eco", imageEmoji: "üå±", continueText: "Let's continue" },
                "Very important": { emoji: "üåç", word: "Committed", imageEmoji: "üíö", continueText: "Let's continue" },
                "Essential": { emoji: "üåø", word: "Dedicated", imageEmoji: "üå≥", continueText: "Let's continue" },
                default: { emoji: "‚ôªÔ∏è", word: "Eco", imageEmoji: "üå±", continueText: "Let's continue" }
            },
            q17: { default: { emoji: "üåç", word: "African", imageEmoji: "ü¶Å", continueText: "Let's continue" } },
            q18: { default: { emoji: "ü¶ò", word: "Australian", imageEmoji: "üá¶üá∫", continueText: "Let's continue" } },
            q19: { default: { emoji: "üíñ", word: "Beneficial", imageEmoji: "üåü", continueText: "Let's continue" } },
            q20: {
                "Budget-friendly (under 15,000 XAF / $30 AUD)": { emoji: "üí∏", word: "Affordable", imageEmoji: "ü§ë", continueText: "Let's continue" },
                "Mid-range (15,000-35,000 XAF / $30-$70 AUD)": { emoji: "üí∞", word: "Balanced", imageEmoji: "‚öñÔ∏è", continueText: "Let's continue" },
                "Premium (35,000-60,000 XAF / $70-$120 AUD)": { emoji: "üí≥", word: "Premium", imageEmoji: "üëë", continueText: "Let's continue" },
                "Luxury (over 60,000 XAF / $120 AUD)": { emoji: "üíé", word: "Luxury", imageEmoji: "üèÜ", continueText: "Let's continue" },
                default: { emoji: "üí∞", word: "Balanced", imageEmoji: "‚öñÔ∏è", continueText: "Let's continue" }
            },
            q21: { default: { emoji: "üéâ", word: "Engaged", imageEmoji: "üéä", continueText: "Let's continue" } }
        };

        function saveProgress() {
            localStorage.setItem('surveyAnswers', JSON.stringify(answers));
            localStorage.setItem('currentSection', currentSectionIndex);
            localStorage.setItem('score', score);
            localStorage.setItem('visits', visits);
        }

        function loadProgress() {
            const savedAnswers = localStorage.getItem('surveyAnswers');
            if (savedAnswers) {
                answers = JSON.parse(savedAnswers);
            }
            const savedSection = localStorage.getItem('currentSection');
            if (savedSection) {
                currentSectionIndex = parseInt(savedSection);
            }
            const savedScore = localStorage.getItem('score');
            if (savedScore) {
                score = parseInt(savedScore);
            }
            const savedVisits = localStorage.getItem('visits');
            if (savedVisits) {
                visits = parseInt(savedVisits);
            }
            visits++;
            localStorage.setItem('visits', visits);
            if (visits > 1) {
                document.getElementById('streak-counter').style.display = 'block';
                document.getElementById('streak-count').textContent = visits;
            }
        }

        function validateSection() {
            const currentSection = surveyData[currentLang].sections[currentSectionIndex];
            for (const q of currentSection.questions) {
                if (q.required) {
                    if (q.type === 'radio') {
                        const checked = document.querySelector(`input[name="${q.id}"]:checked`);
                        if (!checked) return false;
                    } else if (q.type === 'checkbox') {
                        const checked = document.querySelectorAll(`input[name="${q.id}"]:checked`);
                        if (checked.length === 0) return false;
                    } else if (q.type === 'text') {
                        const input = document.querySelector(`input[name="${q.id}"]`);
                        if (!input.value.trim()) return false;
                    }
                }
            }
            return true;
        }

        function createConfetti() {
            const canvas = document.createElement('canvas');
            canvas.style.position = 'fixed';
            canvas.style.top = '0';
            canvas.style.left = '0';
            canvas.style.width = '100%';
            canvas.style.height = '100%';
            canvas.style.pointerEvents = 'none';
            canvas.style.zIndex = '1000';
            document.body.appendChild(canvas);
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            const particles = [];
            for (let i = 0; i < 100; i++) {
                particles.push({
                    x: Math.random() * canvas.width,
                    y: Math.random() * canvas.height,
                    vx: (Math.random() - 0.5) * 10,
                    vy: Math.random() * 5 + 5,
                    color: `hsl(${Math.random() * 360}, 100%, 50%)`,
                    size: Math.random() * 5 + 5
                });
            }
            function animate() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                particles.forEach(p => {
                    p.x += p.vx;
                    p.y += p.vy;
                    p.vy += 0.1;
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                    ctx.fillStyle = p.color;
                    ctx.fill();
                });
                if (particles.some(p => p.y < canvas.height)) {
                    requestAnimationFrame(animate);
                } else {
                    document.body.removeChild(canvas);
                }
            }
            animate();
        }

        function showSadPopup() {
            const sadText = currentLang === 'en' ? 'Why are you not answering all?' : 'Pourquoi ne r√©ponds-tu pas √† tout ?';
            document.getElementById('sad-text').textContent = sadText;
            const popup = document.getElementById('sad-popup');
            popup.style.display = 'flex';
            setTimeout(() => { popup.style.display = 'none'; }, 3000);
        }

        const surveyContentEl = document.getElementById('survey-content');
        const progressBarEl = document.getElementById('progress-bar');
        const progressTextEl = document.getElementById('progress-text');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitBtn = document.getElementById('submit-btn');
        const congratsPopup = document.getElementById('congrats-popup');
        const mascotEmojiEl = document.getElementById('mascot-emoji');

        function showFeedback(qId, selectedValue) {
            const feedbackEl = document.getElementById(`feedback-${qId}`);
            if (!feedbackEl) return;
            const feedbackData = feedbackMap[qId];
            if (!feedbackData) return;
            let fb;
            if (Array.isArray(selectedValue)) {
                // For checkboxes, use default if any selected
                fb = feedbackData.default;
            } else if (feedbackData[selectedValue]) {
                fb = feedbackData[selectedValue];
            } else if (feedbackData.default) {
                fb = feedbackData.default;
            } else {
                return;
            }
            feedbackEl.innerHTML = `
                <div class="feedback-emoji">${fb.emoji}</div>
                <div class="feedback-word">${fb.word}</div>
                <div class="feedback-image">${fb.imageEmoji}</div>
                <div class="continue-text">${fb.continueText}</div>
            `;
            feedbackEl.style.display = 'flex';
            // Auto-hide after 1 second with fade-out
            setTimeout(() => {
                feedbackEl.classList.add('fade-out');
                setTimeout(() => {
                    feedbackEl.style.display = 'none';
                    feedbackEl.classList.remove('fade-out');
                }, 500);
            }, 1000);
        }

        function updateHeader() {
            const header = document.querySelector('.header-content h1');
            const desc = document.querySelector('.header-content p');
            header.textContent = surveyData[currentLang].title;
            desc.textContent = surveyData[currentLang].description;
        }

        function renderSection() {
            const currentSection = surveyData[currentLang].sections[currentSectionIndex];
            surveyContentEl.innerHTML = ''; // Clear previous content

            // Create section container
            const sectionContainer = document.createElement('div');
            sectionContainer.className = 'section-container';

            const sectionTitle = document.createElement('h2');
            sectionTitle.textContent = currentSection.title;
            sectionContainer.appendChild(sectionTitle);

            if (visits > 1) {
                const teaser = document.createElement('div');
                teaser.innerHTML = '<p>Quick Tip: Try shea butter for dryness!</p>';
                sectionContainer.appendChild(teaser);
            }

            currentSection.questions.forEach(q => {
                const questionContainer = document.createElement('div');
                questionContainer.className = 'question-container';

                const questionText = document.createElement('p');
                questionText.className = 'question-text';
                questionText.textContent = q.text;
                questionContainer.appendChild(questionText);

                // Create options based on question type
                const optionsContainer = document.createElement('div');
                optionsContainer.className = 'options-container';
                if (q.type === 'radio') {
                    optionsContainer.setAttribute('role', 'radiogroup');
                } else if (q.type === 'checkbox') {
                    optionsContainer.setAttribute('role', 'group');
                }

                if (q.type === 'radio' || q.type === 'checkbox') {
                    q.options.forEach(option => {
                        const label = document.createElement('label');
                        label.className = `${q.type}-label`;

                        const input = document.createElement('input');
                        input.type = q.type;
                        input.name = q.id;
                        input.value = option;

                        const buttonSpan = document.createElement('span');
                        buttonSpan.className = `${q.type}-box`;

                        label.appendChild(input);
                        label.appendChild(buttonSpan);
                        label.appendChild(document.createTextNode(option));

                        optionsContainer.appendChild(label);

                        // Set the selected state from `answers` object
                        if (q.type === 'radio' && answers[q.id] === option) {
                            input.checked = true;
                            label.classList.add('selected');
                        } else if (q.type === 'checkbox' && answers[q.id] && answers[q.id].includes(option)) {
                            input.checked = true;
                            label.classList.add('selected');
                        }
                    });
                } else if (q.type === 'text') {
                    const input = document.createElement('input');
                    input.type = 'text';
                    input.name = q.id;
                    input.className = 'text-input';
                    input.value = answers[q.id] || '';
                    input.placeholder = q.placeholder || '';
                    if (q.required) input.setAttribute('aria-required', 'true');
                    input.addEventListener('blur', () => {
                        if (input.value.trim()) {
                            showFeedback(q.id, input.value);
                        } else {
                            document.getElementById(`feedback-${q.id}`).style.display = 'none';
                        }
                    });
                    optionsContainer.appendChild(input);
                }

                const feedbackContainer = document.createElement('div');
                feedbackContainer.className = 'feedback-container';
                feedbackContainer.id = `feedback-${q.id}`;
                questionContainer.appendChild(optionsContainer);
                questionContainer.appendChild(feedbackContainer);

                if (q.extraFields) {
                    const extraHeaderText = currentLang === 'en' ? 'If yes, please provide:' : 'Si oui, veuillez fournir :';
                    const nameLabel = currentLang === 'en' ? 'Name:' : 'Nom :';
                    const emailLabel = currentLang === 'en' ? 'Email:' : 'Email :';
                    const phoneLabel = currentLang === 'en' ? 'Phone number:' : 'Num√©ro de t√©l√©phone :';
                    const namePlaceholder = currentLang === 'en' ? 'Your full name' : 'Votre nom complet';
                    const emailPlaceholder = currentLang === 'en' ? 'your.email@example.com' : 'votre.email@example.com';
                    const phonePlaceholder = '+1234567890';
                    const extraFieldsContainer = document.createElement('div');
                    extraFieldsContainer.className = 'extra-fields-container';
                    extraFieldsContainer.id = `extra-${q.id}`;
                    extraFieldsContainer.innerHTML = `
                        <div class="extra-header">${extraHeaderText}</div>
                        <label>${nameLabel}</label>
                        <input type="text" id="name-${q.id}" value="${answers[`name-${q.id}`] || ''}" placeholder="${namePlaceholder}">
                        <label>${emailLabel}</label>
                        <input type="email" id="email-${q.id}" value="${answers[`email-${q.id}`] || ''}" placeholder="${emailPlaceholder}">
                        <label>${phoneLabel}</label>
                        <input type="tel" id="phone-${q.id}" value="${answers[`phone-${q.id}`] || ''}" placeholder="${phonePlaceholder}">
                    `;
                    questionContainer.appendChild(extraFieldsContainer);
                }

                // Show feedback if already answered
                if (q.type === 'radio' && answers[q.id]) {
                    showFeedback(q.id, answers[q.id]);
                } else if (q.type === 'checkbox' && answers[q.id] && answers[q.id].length > 0) {
                    showFeedback(q.id, answers[q.id]);
                } else if (q.type === 'text' && answers[q.id]) {
                    showFeedback(q.id, answers[q.id]);
                }

                // Show extra fields if already selected
                if (q.extraFields && answers[q.id] && Array.isArray(answers[q.id]) && answers[q.id].some(v => v.startsWith('Yes') || v.startsWith('Oui'))) {
                    const extraFieldElement = document.getElementById(`extra-${q.id}`);
                    if (extraFieldElement) {
                        extraFieldElement.style.display = 'block';
                    }
                }

                sectionContainer.appendChild(questionContainer);
            });

            surveyContentEl.appendChild(sectionContainer);
            updateProgressBar();
            updateButtons();
            updateMascotEmoji();
            // Scroll to the first question of the new section
            sectionContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function updateProgressBar() {
            const totalSections = surveyData[currentLang].sections.length;
            const progressPercentage = ((currentSectionIndex + 1) / totalSections) * 100;
            progressBarEl.style.width = `${progressPercentage}%`;
            progressTextEl.textContent = `${currentSectionIndex + 1}/${totalSections} - Score: ${score}`;
        }

        function updateButtons() {
            prevBtn.textContent = buttonTexts[currentLang].prev;
            nextBtn.textContent = buttonTexts[currentLang].next;
            submitBtn.textContent = buttonTexts[currentLang].submit;
            prevBtn.style.display = currentSectionIndex > 0 ? 'inline-block' : 'none';
            if (currentSectionIndex === surveyData[currentLang].sections.length - 1) {
                nextBtn.style.display = 'none';
                submitBtn.style.display = 'inline-block';
            } else {
                nextBtn.style.display = 'inline-block';
                submitBtn.style.display = 'none';
            }
        }

        function updateMascotEmoji() {
            mascotEmojiEl.textContent = mascotEmojis[currentSectionIndex % mascotEmojis.length];
        }

        function collectAnswers() {
            const currentSection = surveyData[currentLang].sections[currentSectionIndex];
            currentSection.questions.forEach(q => {
                if (q.type === 'radio') {
                    const checkedRadio = document.querySelector(`input[name="${q.id}"]:checked`);
                    if (checkedRadio) {
                        answers[q.id] = checkedRadio.value;
                    }
                } else if (q.type === 'checkbox') {
                    const checkedCheckboxes = document.querySelectorAll(`input[name="${q.id}"]:checked`);
                    answers[q.id] = Array.from(checkedCheckboxes).map(input => input.value);
                } else if (q.type === 'text') {
                    const textInput = document.querySelector(`input[name="${q.id}"]`);
                    if (textInput) {
                        answers[q.id] = textInput.value;
                    }
                }

                if (q.extraFields) {
                    const nameInput = document.getElementById(`name-${q.id}`);
                    if (nameInput) answers[`name-${q.id}`] = nameInput.value.trim();
                    const emailInput = document.getElementById(`email-${q.id}`);
                    if (emailInput) answers[`email-${q.id}`] = emailInput.value.trim();
                    const phoneInput = document.getElementById(`phone-${q.id}`);
                    if (phoneInput) answers[`phone-${q.id}`] = phoneInput.value.trim();
                }
            });
        }

        function animateSection(direction) {
            surveyContentEl.style.transition = 'none';
            if (direction === 'next') {
                surveyContentEl.style.transform = 'translateX(-100vw)';
                setTimeout(() => {
                    renderSection();
                    surveyContentEl.style.transition = 'transform 0.6s ease-out';
                    surveyContentEl.style.transform = 'translateX(0)';
                }, 100);
            } else {
                surveyContentEl.style.transform = 'translateX(100vw)';
                setTimeout(() => {
                    renderSection();
                    surveyContentEl.style.transition = 'transform 0.6s ease-out';
                    surveyContentEl.style.transform = 'translateX(0)';
                }, 100);
            }
        }

        function handleNext() {
            collectAnswers();
            if (!validateSection()) {
                showSadPopup();
            }
            score += 25;
            saveProgress();
            currentSectionIndex++;
            if (currentSectionIndex === 2 || currentSectionIndex === 4) {
                createConfetti();
                mascotEmojiEl.textContent = 'üèÜ';
            }
            animateSection('next');
        }

        function handlePrevious() {
            collectAnswers();
            currentSectionIndex--;
            animateSection('prev');
        }

function handleSubmit() {
    collectAnswers();
    if (!validateSection()) {
        showSadPopup();
    }
    score += 25;
    saveProgress();

    document.getElementById('congrats-text').textContent = congratsTexts[currentLang];
    congratsPopup.style.display = 'flex';

    // Submit to Google Sheets via Google Apps Script
    const formData = new FormData();
    formData.append('timestamp', new Date().toISOString());
    // --- START OF NEW CODE TO CAPTURE Q21 EXTRA FIELDS ---
    // Only capture these fields if the user has opted in (q21 is present and says 'Yes' or 'Oui')
    // ... (lines before the new code block)

    // --- START OF NEW CODE TO CAPTURE Q21 EXTRA FIELDS ---
    const q21Value = Array.isArray(answers['q21']) ? answers['q21'].join(', ') : answers['q21'];

    if (q21Value && (q21Value.includes('Yes') || q21Value.includes('Oui'))) {
        // Capture the Name, Email, and Phone inputs by their unique IDs
        const nameInput = document.getElementById('name-q21');
        const emailInput = document.getElementById('email-q21');
        const phoneInput = document.getElementById('phone-q21');

        // *** CRITICAL FIX: Add the values to the central 'answers' object ***
        if (nameInput) {
            answers['name-q21'] = nameInput.value || '';
        }
        if (emailInput) {
            answers['email-q21'] = emailInput.value || '';
        }
        if (phoneInput) {
            answers['phone-q21'] = phoneInput.value || '';
        }
    }
    
// ... (The rest of your script, which sends the 'answers' object, remains the same)
// ...
   
        // ... (rest of your loop remains the same) ...
    for (const key in answers) {
        let value = answers[key];
        if (Array.isArray(value)) value = value.join(', ');
        formData.append(key, value);
    }

    fetch('https://script.google.com/macros/s/AKfycbzRYBQTeuC4Hgp9-S5ILa6LguppGxb_keBHpcOipEo9oT_fwV7aWhgEc4gfO1fkQflV/exec', {
        method: 'POST',
        body: formData
    })
    .then(response => {
        if (!response.ok) {
            throw new Error('Network response was not ok');
        }
        return response.json();
    })
    .then(data => {
        console.log("Submission Success:", data);
        congratsPopup.style.display = 'none';
        alert(alertTexts[currentLang].success);
        // Reset survey state after submission
        answers = {};
        currentSectionIndex = 0;
        score = 0;
        saveProgress();
        renderSection();
    })
    .catch(error => {
        console.error("Submission Failed:", error);
        congratsPopup.style.display = 'none';
        alert(alertTexts[currentLang].error);
    });
}


    window.onload = function() {
        loadProgress();
        // Show language selection overlay and hide main content initially
        document.getElementById('language-overlay').style.display = 'flex';
        document.querySelector('.app-container').style.display = 'none';
    };
nextBtn.addEventListener('click', handleNext);
prevBtn.addEventListener('click', handlePrevious);
submitBtn.addEventListener('click', handleSubmit);

document.getElementById('lang-toggle').addEventListener('click', function() {
    currentLang = currentLang === 'en' ? 'fr' : 'en';
    this.textContent = currentLang === 'en' ? 'Fran√ßais' : 'English';
    updateHeader();
    renderSection();
});

document.getElementById('select-en').addEventListener('click', function() {
    currentLang = 'en';
    document.getElementById('language-overlay').style.display = 'none';
    document.querySelector('.app-container').style.display = 'block';
    updateHeader();
    renderSection();
});

document.getElementById('select-fr').addEventListener('click', function() {
    currentLang = 'fr';
    document.getElementById('language-overlay').style.display = 'none';
    document.querySelector('.app-container').style.display = 'block';
    updateHeader();
    renderSection();
});

        // Option selection and animation handler
        surveyContentEl.addEventListener('click', function(e) {
            const label = e.target.closest('label.radio-label, label.checkbox-label');
            if (!label) return;
            const input = label.querySelector('input');
            if (!input) return;
            // For radio: unselect all in group
            if (input.type === 'radio') {
                const radios = document.querySelectorAll(`input[name='${input.name}']`);
                radios.forEach(radio => {
                    radio.checked = false;
                    if (radio.parentElement.classList.contains('selected')) {
                        radio.parentElement.classList.remove('selected');
                    }
                });
                input.checked = true;
                label.classList.add('selected');
                // Animation reflow
                label.classList.remove('selected');
                void label.offsetWidth;
                label.classList.add('selected');
                showFeedback(input.name, input.value);
            } else if (input.type === 'checkbox') {
                input.checked = !input.checked;
                if (input.checked) {
                    label.classList.add('selected');
                    // Animation reflow
                    label.classList.remove('selected');
                    void label.offsetWidth;
                    label.classList.add('selected');
                } else {
                    label.classList.remove('selected');
                }
                const checked = document.querySelectorAll(`input[name='${input.name}']:checked`);
                const values = Array.from(checked).map(i => i.value);
                showFeedback(input.name, values);

                // Toggle extra fields for q21
                if (input.name === 'q21') {
                    const extraEl = document.getElementById('extra-q21');
                    const yesChecked = values.some(v => v.startsWith('Yes') || v.startsWith('Oui'));
                    extraEl.style.display = yesChecked ? 'block' : 'none';
                }
            }
        });

        // Carousel logic for header images
const headerImages = [
    './assets/OIP (12).jpg',
    './assets/OIP (10).webp',
    './assets/OIP (11).jpg'
];
let currentImage = 0;
const headerImagesContainer = document.querySelector('.header-images');
function showCarouselImage(idx) {
    const img = headerImagesContainer.querySelector('img');
    if (img) {
        img.src = headerImages[idx];
    }
}
function nextCarouselImage() {
    currentImage = (currentImage + 1) % headerImages.length;
    showCarouselImage(currentImage);
}
showCarouselImage(currentImage);
setInterval(nextCarouselImage, 3000);
    </script>
</body>
</html>